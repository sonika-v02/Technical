ALTER TABLE Customers
ADD OrderCount INT DEFAULT 0;
SET SQL_SAFE_UPDATES = 0;
UPDATE Customers
SET OrderCount=(
SELECT COUNT(*)
FROM Orders
WHERE Orders.CustomerId=Customers.CustomerId);
SELECT * FROM Customers;
UPDATE Customers
SET OrderCount='2'
WHERE CustomerId=5;

SELECT Orders.OrderID, Orders.OrderDate, Customers.FirstName, Customers.LastName, Customers.Email, Customers.Phone, Customers.Address
FROM Orders 
JOIN Customers ON Orders.CustomerId=Customers.CustomerId;

SELECT Products.ProductName, SUM(OrderDetails.Quantity*Products.Price) AS TotalRevenue
FROM OrderDetails
JOIN Products ON OrderDetails.ProductID=Products.ProductID
GROUP BY Products.ProductName;

ALTER TABLE Products
ADD ProductType VARCHAR(20);
UPDATE Products
SET ProductType='Electronics';
SELECT * FROM Products;

SELECT Customers.FirstName, Customers.LastName, Customers.Email, Customers.Phone, Customers.Address
FROM Customers
JOIN Orders ON Customers.CustomerId=Orders.CustomerId;

USE TechShop;
SELECT ProductName
FROM Products
WHERE ProductType='Electronics';

SELECT * FROM Customers;

SELECT Products.ProductName, SUM(OrderDetails.Quantity) AS TotalQuantity
FROM OrderDetails
JOIN Products ON OrderDetails.ProductID=Products.ProductID
WHERE Products.ProductType='Electronics'
GROUP BY Products.ProductName
ORDER BY TotalQuantity DESC;

SELECT Customers.FirstName, Customers.LastName, AVG(Orders.TotalAmount) AS TotalValue
FROM Orders
JOIN Customers ON Customers.CustomerId=Orders.CustomerId
GROUP BY Customers.CustomerId;

SELECT Orders.OrderID, Customers.FirstName, Customers.LastName, SUM(OrderDetails.Quantity) AS OrderRevenue
FROM Orders
JOIN OrderDetails ON Orders.OrderID=OrderDetails.OrderID
JOIN Customers ON Orders.CustomerId=Customers.CustomerId
GROUP BY Orders.OrderID, Customers.FirstName, Customers.LastName
ORDER BY OrderRevenue DESC;